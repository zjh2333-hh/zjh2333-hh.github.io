{{/*
  Custom homepage "Papers" view.
  Renders: Title -> Authors -> Venue (italic) -> Links (arXiv/PDF)

  Note: Hugo Blox may call view partials with either:
  - the Page as context, OR
  - a dict containing `.page` / `.item`
  So we normalize to `$p`.
*/}}

{{ $p := . }}
{{ with .page }}{{ $p = . }}{{ end }}
{{ with .item }}{{ $p = . }}{{ end }}

<div class="papers-item">
  <div class="papers-title">
    <a href="{{ $p.RelPermalink }}">{{ $p.Title }}</a>
  </div>

  {{/* Authors */}}
  {{ $authors := $p.Params.authors }}
  {{/* Optional: mark equal contribution authors with asterisk
       Usage in a publication front matter:
       equal_contrib:
       - admin
       - Jingwu Tang
  */}}
  {{ $equal := $p.Params.equal_contrib }}
  {{/* Optional: append a note after the author list, e.g. "(alphabetical order)" */}}
  {{ $authorNote := $p.Params.author_note }}
  {{ if $authors }}
    <div class="papers-authors">
      {{ range $i, $a := $authors }}
        {{ $aClean := strings.TrimSuffix "*" $a }}
        {{ $shouldStar := false }}
        {{ if $equal }}
          {{ range $equal }}
            {{ if or (eq . $aClean) (eq (lower .) (lower $aClean)) }}
              {{ $shouldStar = true }}
            {{ end }}
          {{ end }}
        {{ end }}
        {{ if gt $i 0 }}, {{ end }}
        {{ if eq (lower $aClean) "admin" }}
          Jiahao Zhang{{ if $shouldStar }}*{{ end }}
        {{ else }}
          {{ $aClean }}{{ if $shouldStar }}*{{ end }}
        {{ end }}
      {{ end }}
      {{ with $authorNote }} ({{ . }}){{ end }}
    </div>
  {{ end }}

  {{/* Venue */}}
  {{ with $p.Params.publication }}
    <div class="papers-venue"><em>{{ . }}</em></div>
  {{ end }}

  {{/* Links */}}
  {{ with $p.Params.links }}
    <div class="papers-links">
      {{ range . }}
        {{ $name := .name | default "Link" }}
        {{ $url := .url }}
        {{ if $url }}
          <a class="papers-link" href="{{ $url }}" target="_blank" rel="noopener">{{ $name }}</a>
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
</div>


